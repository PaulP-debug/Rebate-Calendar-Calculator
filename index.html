<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rebate Calendar Calculator</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  input, select, textarea { display: block; margin-bottom: 10px; width: 300px; padding: 5px; }
  textarea { height: 150px; }
  button { padding: 10px 20px; font-size: 16px; border-radius: 4px; border: none; margin-right: 10px; cursor: pointer; }
  table { border-collapse: collapse; margin-top: 10px; width: 100%; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
  .valid-range { background-color: #c6efce; }
  #modeLabel { font-size: 18px; font-weight: bold; margin-top: 20px; }
  #loginContainer { text-align:center; margin-top:100px; }
</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginContainer">
  <h2>Login</h2>
  <input type="text" id="username" placeholder="Username">
  <input type="password" id="password" placeholder="Password">
  <button onclick="login()">Login</button>
  <p id="loginMessage" style="color:red;"></p>
</div>

<div id="appContainer" style="display:none;">

<h2>Rebate Calendar Calculator</h2>

<label>1. Rebate Date (YYYY-MM-DD HH:MM:SS)</label>
<input type="text" id="rebateDate">

<label>2. Tier</label>
<select id="tier">
  <option value="2">Tier 2 (7 days)</option>
  <option value="3">Tier 3 (9 days)</option>
</select>

<!-- ✅ TIMEZONE CONVERTER -->
<h3>3. Timezone Converter (Input UTC)</h3>
<label>Backend Time (UTC)</label>
<input type="text" id="timezoneInput" placeholder="YYYY-MM-DD HH:MM:SS" oninput="updateTimezones()">
<div id="timezoneResult"></div>

<label>4. Purchase Dates (one per line)</label>
<textarea id="purchaseDates"></textarea>

<button onclick="calculateAcorn()" style="background:#FFFF00;color:black;">Calculate (ACORN + LEGENDS)</button>
<button onclick="calculateLegends()" style="background:#8A2BE2;color:white;">Calculate (OLD_LEGENDS)</button>
<button onclick="logout()" style="background:#f44336;color:white;">Logout</button>

<h3>5. Result</h3>
<div id="modeLabel"></div>
<div id="result"></div>

</div>

<script>
const USERNAME="LEGENDS_ADMIN", PASSWORD="AcornLegends2025";

function login(){
  if(username.value===USERNAME && password.value===PASSWORD){
    loginContainer.style.display="none";
    appContainer.style.display="block";
    localStorage.setItem("loggedIn","true");
  } else loginMessage.textContent="Invalid credentials.";
}
if(localStorage.getItem("loggedIn")==="true"){
  loginContainer.style.display="none";
  appContainer.style.display="block";
}
function logout(){localStorage.clear();location.reload();}

function parseLocalDate(str){
  if(!str) return null;
  const d=new Date(str.replace(" ","T"));
  return isNaN(d)?null:d;
}
function format24h(dt){
  return `${dt.getFullYear()}-${String(dt.getMonth()+1).padStart(2,'0')}-${String(dt.getDate()).padStart(2,'0')} ${String(dt.getHours()).padStart(2,'0')}:${String(dt.getMinutes()).padStart(2,'0')}:${String(dt.getSeconds()).padStart(2,'0')}`;
}

/* TIMEZONE CONVERTER */
function updateTimezones(){
  const dt=parseLocalDate(timezoneInput.value);
  if(!dt){timezoneResult.innerHTML="<p style='color:red'>Invalid date</p>";return;}

  const zones={
    "PST (Server)":{o:-8,c:"#cce5ff"},
    "MST":{o:-7,c:"#d4edda"},
    "CST":{o:-6,c:"#fff3cd"},
    "EST":{o:-5,c:"#ffe5b4"}
  };

  let h="<table><tr style='background:#333;color:white'><th>Timezone</th><th>Date & Time</th></tr>";
  for(const z in zones){
    const d=new Date(dt.getTime()+zones[z].o*3600000);
    h+=`<tr style="background:${zones[z].c}"><td>${z}</td><td>${format24h(d).slice(0,16)}</td></tr>`;
  }
  timezoneResult.innerHTML=h+"</table>";
}
</script>

<p style="text-align:right; font-style:italic; margin-top:40px;">— by: Paul P</p>

</body>
</html>
